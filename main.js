!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?t(Object(n),!0).forEach((function(t){var r,i,u;r=e,i=t,u=n[t],(i=o(i))in r?Object.defineProperty(r,i,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[i]=u})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function o(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}var i=new(function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.baseUrl=t,this.headers=r},(t=[{key:"getUserInfo",value:function(){return fetch("".concat(this.baseUrl,"/users/me"),{headers:this.headers}).then((function(e){if(!e.ok)throw new Error("Server error: ".concat(e.status));return e.json()})).catch((function(e){return console.error("Error:",e)}))}},{key:"getInitialCards",value:function(){return fetch("".concat(this.baseUrl,"/cards"),{headers:this.headers}).then((function(e){if(!e.ok)throw new Error("Server error: ".concat(e.status));return e.json()})).catch((function(e){return console.error("Error:",e)}))}},{key:"modifyUsersInfo",value:function(e,t){return fetch("".concat(this.baseUrl,"/users/me"),{method:"PATCH",headers:r(r({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify({name:e,about:t})}).then((function(e){if(!e.ok)throw new Error("Server error: ".concat(e.status));return e.json()})).catch((function(e){return console.error("Error:",e)}))}},{key:"getNewCard",value:function(e,t){return fetch("".concat(this.baseUrl,"/cards"),{method:"POST",headers:r(r({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify({name:e,link:t})}).then((function(e){if(!e.ok)throw new Error("Server error: ".concat(e.status));return e.json()})).catch((function(e){return console.error("Error:",e)}))}},{key:"likeCard",value:function(e,t){var r=t?"PUT":"DELETE";return fetch("".concat(this.baseUrl,"/cards/likes/").concat(e),{method:r,headers:this.headers}).then((function(e){if(!e.ok)throw new Error("Server error: ".concat(e.status));return e.json()})).catch((function(e){console.error("Error: can't apply like",e)}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this.headers}).then((function(e){if(!e.ok)throw new Error("Server error: ".concat(e.status));return e.json()})).catch((function(e){return console.error("Error:",e)}))}},{key:"resetAvatar",value:function(e){return fetch("".concat(this.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:r(r({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify({avatar:e})}).then((function(e){if(!e.ok)throw new Error("Server error: ".concat(e.status));return e.json()})).catch((function(e){return console.error("Error:",e)}))}}])&&n(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}())("https://around.nomoreparties.co/v1/web_es_12",{authorization:"39689808-444a-43ae-b51c-8f177d6060a9"});function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}var l=function(){return e=function e(t,r,n,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._title=t.name,this._link=t.link,this._likes=Array.isArray(t.likes)?t.likes:[],this._cardId=t._id,this._templateSelector=r,this._element=this._getTemplate(),this._element.id=this._cardId,this._cardImage=this._element.querySelector(".card__photo"),this._cardTitle=this._element.querySelector(".card__info-name"),this._likeButton=this._element.querySelector(".card__like-button"),this._counterLikes=this._element.querySelector(".card__likes"),this._currentUser=n,this._handleCardLike=o,this._handleCardDelete=i,this._ownerId=t.owner._id,this._bindListeners(),this._updateLikeStatus()},t=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".card").cloneNode(!0)}},{key:"_bindListeners",value:function(){var e=this;this._likeButton.addEventListener("click",(function(){return e._handleLike()})),this._cardImage.addEventListener("click",(function(){return e._handleImageClick()})),this._currentUser===this._ownerId&&this._element.querySelector(".card__delete-button").addEventListener("click",(function(){return e._handleDelete()}))}},{key:"_handleLike",value:function(){var e=this,t=!this._likes.some((function(t){return t._id===e._currentUser}));this._toggleLike(t)}},{key:"_toggleLike",value:function(e){var t=this;this._handleCardLike(this._cardId,e).then((function(e){if(!Array.isArray(e.likes))throw new Error("Invalid updated likes: not an array");t._likes=e.likes,t._updateLikeStatus()})).catch((function(e){console.error("Error toggling like: ".concat(e))}))}},{key:"_handleDelete",value:function(){var e=this;i.deleteCard(this._cardId).then((function(){e._element.remove()})).catch((function(e){return console.error("Error:",e)}))}},{key:"_handleImageClick",value:function(){var e=this,t=document.querySelector("#popup_image-open"),r=document.querySelector("#popup__close-image"),n=document.querySelector(".popup__image-title"),o=document.querySelector(".popup__image"),i=document.querySelector("#popup-overlay-image");o.src=this._link,n.textContent=this._title,o.alt=this._title,t.classList.add("popup_opened"),r.addEventListener("click",(function(){t.classList.remove("popup_opened"),i.removeEventListener("click",e._handleOverlayClick)})),i.addEventListener("click",(function(){t.classList.remove("popup_opened"),i.removeEventListener("click",e._handleOverlayClick)}))}},{key:"_updateLikeStatus",value:function(){var e=this;Array.isArray(this._likes)&&(this._likes.some((function(t){return t._id===e._currentUser}))?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active"),this._counterLikes.textContent=this._likes.length)}},{key:"generateCard",value:function(){return this._cardTitle.textContent=this._title,this._cardImage.src=this._link,this._cardImage.alt=this._title,this._updateLikeStatus(),this._element}}],t&&c(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}var y=function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._formElement=t,this._formSelector=r.formSelector,this._inputSelector=r.inputSelector,this._submitButtonSelector=r.submitButtonSelector,this._inactiveButtonClass=r.inactiveButtonClass,this._inputErrorClass=r.inputErrorClass,this._errorClass=r.errorClass,this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this.inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._setEventListeners()},(t=[{key:"_showInputError",value:function(e,t){e.classList.add(this._inputErrorClass),this._formElement.querySelector("#".concat(e.id,"-error")).textContent=t}},{key:"_hideInputError",value:function(e){e.classList.remove(this._inputErrorClass),this._formElement.querySelector("#".concat(e.id,"-error")).textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(){return this.inputList.some((function(e){return!e.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput(this.inputList)?this._buttonElement.classList.add(this._inactiveButtonClass):this._buttonElement.classList.remove(this._inactiveButtonClass)}},{key:"_setEventListeners",value:function(){var e=this;this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this.inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))})),this._toggleButtonState()}}])&&p(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function h(e){var t=function(e,t){if("object"!=v(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==v(t)?t:t+""}var m=function(){return e=function e(t,r){var n=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=n,this._renderer=o,this._cardsSelector=r},(t=[{key:"render",value:function(){var e=this;this._items.forEach((function(t){e._renderer(t)}))}},{key:"addItem",value:function(e){this._cardsSelector.prepend(e)}}])&&d(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function S(e){var t=function(e,t){if("object"!=b(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==b(t)?t:t+""}var g=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.popupSelector=document.querySelector(t),this.popupCloseButton=this.popupSelector.querySelector(".popup__close-button")},(t=[{key:"open",value:function(){this.popupSelector.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose.bind(this))}},{key:"close",value:function(){this.popupSelector.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose.bind(this))}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"_handleOverlayClick",value:function(e){return e.target.classList.contains("popup_opened")}},{key:"setEventListeners",value:function(){var e=this;this.popupCloseButton.addEventListener("click",(function(){e.close()})),this.popupSelector.addEventListener("click",(function(t){t.target===e.popupSelector&&e.close()}))}}])&&_(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E(n.key),n)}}function E(e){var t=function(e,t){if("object"!=w(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==w(t)?t:t+""}function O(e,t,r){return t=P(t),function(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,j()?Reflect.construct(t,r||[],P(e).constructor):t.apply(e,r))}function j(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(j=function(){return!!e})()}function L(){return L="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},L.apply(this,arguments)}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}function C(e,t){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},C(e,t)}var q=function(e){function t(e,r){var n,o=r.handleFormAvatar;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=O(this,t,[e])).handleFormAvatar=o,n._buttonAvatar=n.popupSelector.querySelector("#popup-avatar__close"),n._spanError=n.popupSelector.querySelector("#popup__input_avatar-error"),n.formAvatar=n.popupSelector.querySelector("#popup-avatar__form"),n.buttonSaveAvatar=n.popupSelector.querySelector("#popup-avatar__button"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}(t,e),r=t,(n=[{key:"open",value:function(){L(P(t.prototype),"open",this).call(this),this.setEventListeners()}},{key:"setEventListeners",value:function(){L(P(t.prototype),"setEventListeners",this).call(this),this._buttonAvatar.addEventListener("click",(function(e){e.preventDefault()}))}},{key:"close",value:function(){L(P(t.prototype),"close",this).call(this),this.formAvatar.reset()}}])&&k(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(g);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B(n.key),n)}}function B(e){var t=function(e,t){if("object"!=I(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==I(t)?t:t+""}function D(e,t,r){return t=R(t),function(e,t){if(t&&("object"===I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,A()?Reflect.construct(t,r||[],R(e).constructor):t.apply(e,r))}function A(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(A=function(){return!!e})()}function x(){return x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=R(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},x.apply(this,arguments)}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}function U(e,t){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},U(e,t)}var N=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=D(this,t,[e])).handleFormSubmit=r,n.form=n.popupSelector.querySelector(".popup__form"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U(e,t)}(t,e),r=t,(n=[{key:"_getInputValues",value:function(){return{name:this.popupSelector.querySelector(".popup__input_title").value,link:this.popupSelector.querySelector("#popup__input_image").value}}},{key:"setEventListeners",value:function(){var e=this;x(R(t.prototype),"setEventListeners",this).call(this),this.form.addEventListener("submit",(function(t){t.preventDefault(),e.handleFormSubmit(t)}))}},{key:"close",value:function(){x(R(t.prototype),"close",this).call(this),this.form.reset()}}])&&T(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(g);function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V(n.key),n)}}function V(e){var t=function(e,t){if("object"!=F(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==F(t)?t:t+""}function H(e,t,r){return t=G(t),function(e,t){if(t&&("object"===F(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,z()?Reflect.construct(t,r||[],G(e).constructor):t.apply(e,r))}function z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(z=function(){return!!e})()}function M(){return M="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=G(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},M.apply(this,arguments)}function G(e){return G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},G(e)}function K(e,t){return K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},K(e,t)}var Q,W=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=H(this,t,[e])).image=r.popupSelector.querySelector(".popup__image"),r.title=r.popupSelector.querySelector(".popup__image-title"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K(e,t)}(t,e),r=t,(n=[{key:"open",value:function(e,r){M(G(t.prototype),"open",this).call(this),this.image.src=e,this.title.textContent=r}}])&&J(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(g),X=document.querySelector(".profile__avatar"),Y=document.querySelector(".profile__name"),Z=document.querySelector(".profile__about"),$=document.querySelector(".profile__edit-button"),ee=document.querySelector(".popup__form"),te=document.querySelector("#form-cards"),re=document.querySelector(".popup__input_name"),ne=document.querySelector(".popup__input_about"),oe=document.querySelector(".profile__add-button"),ie=document.querySelector(".popup__input_title"),ue=document.querySelector("#popup__input_image"),ce=document.querySelector(".cards"),ae=document.getElementById("add-image-popup").querySelector(".popup__form"),le=document.querySelector(".profile__edit-icon"),se=document.querySelector("#popup-avatar__form"),pe=document.querySelector("#popup-avatar__button"),fe=document.querySelector("#popup-profile__button"),ye=document.querySelector("#popup-card__button");function ve(e){e.preventDefault();var t=re.value,r=ne.value;fe.textContent="Saving...",i.modifyUsersInfo(t,r).then((function(e){Y.textContent=null==e?void 0:e.name,Z.textContent=null==e?void 0:e.about,me.close()})).catch((function(e){console.error(e)})).finally((function(){fe.textContent="Save"}))}i.getUserInfo().then((function(e){Y.textContent=null==e?void 0:e.name,Z.textContent=null==e?void 0:e.about,X.src=null==e?void 0:e.avatar,Q=null==e?void 0:e._id,i.getInitialCards().then((function(e){var t=new m({items:e,renderer:function(e){var r=new l(e,".template-card",Q,Oe,je).generateCard();t.addItem(r)}},ce);t.render()}))}));var de=new g(".popup"),he=new N("#add-image-popup",(function(e){e.preventDefault(),he.close()})),me=new N(".popup",ve),be=new W("#popup_image-open"),_e=new q("#popup-avatar",{handleFormAvatar:Ee}),Se=document.querySelector("#popup-overlay-edit"),ge=document.querySelector("#popup-overlay-add"),we=document.querySelector("#popup-overlay-image"),ke=document.querySelector("#popup-overlay-avatar");function Ee(e){e.preventDefault();var t=se.querySelector(".popup__input").value;pe.textContent="Saving...",i.resetAvatar(t).then((function(e){X.src=null==e?void 0:e.avatar,_e.close(),pe.textContent="Save"}))}function Oe(e,t){return i.likeCard(e,t).then((function(e){return e})).catch((function(e){throw e}))}function je(e){i.deleteCard(e).then((function(){document.getElementById(e).remove()}))}function Le(e){e.target.classList.contains("popup__overlay")&&(de.close(),he.close(),be.close(),_e.close())}function Pe(e){"Escape"===e.key&&(de.close(),he.close(),be.close(),_e.close(),document.removeEventListener("keydown",Pe))}$.addEventListener("click",(function(){de.open(),i.getUserInfo().then((function(e){re.value=null==e?void 0:e.name,ne.value=null==e?void 0:e.about}))})),ee.addEventListener("submit",ve),oe.addEventListener("click",(function(){return he.open()})),ae.addEventListener("submit",(function(e){e.preventDefault(),ye.textContent="Saving...",ie.value&&ue.value&&i.getNewCard(ie.value,ue.value).then((function(e){var t=new l(e,".template-card",Q,Oe,je).generateCard();ce.prepend(t),ie.value="",ue.value="",he.close(),ye.textContent="Save"}))})),le.addEventListener("click",(function(){return _e.open()})),se.addEventListener("submit",Ee),he.setEventListeners(),Se.addEventListener("click",Le),ge.addEventListener("click",Le),we.addEventListener("click",Le),ke.addEventListener("click",Le),document.addEventListener("keydown",(function(e){return Pe(e)}));var Ce={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};new y(ee,Ce)._setEventListeners(),new y(te,Ce)._setEventListeners(),new y(se,Ce)._setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0FDakNQLEVBQUk4TixXQUFXekMsR0FBVzlLLE1BQU8rSyxHQUFXL0ssT0FBT0csTUFBSyxTQUFDcU4sR0FDdkQsSUFPTUMsRUFQTyxJQUFJL0wsRUFDZjhMLEVBQ0EsaUJBQ0EzTCxFQUNBdUssR0FDQXJLLElBRTBCc0ssZUFDNUJyQixHQUFTMUMsUUFBUW1GLEdBQ2pCM0MsR0FBVzlLLE1BQVEsR0FDbkIrSyxHQUFXL0ssTUFBUSxHQUNuQnlNLEdBQWM3RCxRQUNkMEMsR0FBZXJHLFlBQWMsTUFDL0IsR0FFSixJQThEQWtHLEdBQW9CeEgsaUJBQWlCLFNBQVMsa0JBQU1nSixHQUFnQlcsTUFBTSxJQUMxRWxDLEdBQWtCekgsaUJBQWlCLFNBQVVpSixJQUU3Q0gsR0FBYzdDLG9CQUVkaUQsR0FBWWxKLGlCQUFpQixRQUFTd0osSUFDdENMLEdBQVduSixpQkFBaUIsUUFBU3dKLElBQ3JDcEksR0FBYXBCLGlCQUFpQixRQUFTd0osSUFDdkNKLEdBQWNwSixpQkFBaUIsUUFBU3dKLElBRXhDNUosU0FBU0ksaUJBQWlCLFdBQVcsU0FBQ3lKLEdBQUssT0FBS0MsR0FBYUQsRUFBTSxJQUVuRSxJQUFNekgsR0FBVyxDQUNmRyxhQUFjLGVBQ2RFLGNBQWUsZ0JBQ2ZFLHFCQUFzQixzQkFDdEJFLG9CQUFxQix5QkFDckJFLGdCQUFpQiwwQkFDakJFLFdBQVksd0JBR2MsSUFBSWYsRUFBY0MsR0FBYUMsSUFDdkNrQixxQkFDSyxJQUFJcEIsRUFBY2lGLEdBQWlCL0UsSUFDM0NrQixxQkFDVSxJQUFJcEIsRUFBYzJGLEdBQW1CekYsSUFDN0NrQixvQiIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy91dGlscy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoQXZhdGFyLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKGJhc2VVcmwsIGhlYWRlcnMpIHtcbiAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuaGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHsgaGVhZGVyczogdGhpcy5oZWFkZXJzIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmICghcmVzLm9rKSB0aHJvdyBuZXcgRXJyb3IoYFNlcnZlciBlcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycm9yKSk7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7IGhlYWRlcnM6IHRoaXMuaGVhZGVycyB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKGBTZXJ2ZXIgZXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yOlwiLCBlcnJvcikpO1xuICB9XG5cbiAgbW9kaWZ5VXNlcnNJbmZvKG5hbWUsIGFib3V0KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgLi4udGhpcy5oZWFkZXJzLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGFib3V0IH0pLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmICghcmVzLm9rKSB0aHJvdyBuZXcgRXJyb3IoYFNlcnZlciBlcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycm9yKSk7XG4gIH1cblxuICBnZXROZXdDYXJkKG5hbWUsIGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIC4uLnRoaXMuaGVhZGVycyxcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rIH0pLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmICghcmVzLm9rKSB0aHJvdyBuZXcgRXJyb3IoYFNlcnZlciBlcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycm9yKSk7XG4gIH1cblxuICBsaWtlQ2FyZChjYXJkSWQsIGlzTGlrZWQpIHtcbiAgICBjb25zdCBtZXRob2QgPSBpc0xpa2VkID8gXCJQVVRcIiA6IFwiREVMRVRFXCI7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgaWYgKCFyZXMub2spIHRocm93IG5ldyBFcnJvcihgU2VydmVyIGVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yOiBjYW4ndCBhcHBseSBsaWtlXCIsIGVycm9yKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmICghcmVzLm9rKSB0aHJvdyBuZXcgRXJyb3IoYFNlcnZlciBlcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycm9yKSk7XG4gIH1cblxuICByZXNldEF2YXRhcih1cmwpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgLi4udGhpcy5oZWFkZXJzLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhcjogdXJsIH0pLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmICghcmVzLm9rKSB0aHJvdyBuZXcgRXJyb3IoYFNlcnZlciBlcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycm9yKSk7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGFwaSA9IG5ldyBBcGkoXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL3dlYl9lc18xMlwiLCB7XG4gIGF1dGhvcml6YXRpb246IFwiMzk2ODk4MDgtNDQ0YS00M2FlLWI1MWMtOGYxNzdkNjA2MGE5XCIsXG59KTtcbiIsImltcG9ydCB7IGFwaSB9IGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGNhcmREYXRhLFxuICAgIHRlbXBsYXRlU2VsZWN0b3IsXG4gICAgY3VycmVudFVzZXIsXG4gICAgaGFuZGxlQ2FyZExpa2UsXG4gICAgaGFuZGxlQ2FyZERlbGV0ZVxuICApIHtcbiAgICB0aGlzLl90aXRsZSA9IGNhcmREYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGNhcmREYXRhLmxpbms7XG4gICAgdGhpcy5fbGlrZXMgPSBBcnJheS5pc0FycmF5KGNhcmREYXRhLmxpa2VzKSA/IGNhcmREYXRhLmxpa2VzIDogW107XG4gICAgdGhpcy5fY2FyZElkID0gY2FyZERhdGEuX2lkO1xuICAgIHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IgPSB0ZW1wbGF0ZVNlbGVjdG9yO1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQuaWQgPSB0aGlzLl9jYXJkSWQ7XG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3Bob3RvXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbmZvLW5hbWVcIik7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9jb3VudGVyTGlrZXMgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZXNcIik7XG4gICAgdGhpcy5fY3VycmVudFVzZXIgPSBjdXJyZW50VXNlcjtcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSA9IGhhbmRsZUNhcmRMaWtlO1xuICAgIHRoaXMuX2hhbmRsZUNhcmREZWxldGUgPSBoYW5kbGVDYXJkRGVsZXRlO1xuICAgIHRoaXMuX293bmVySWQgPSBjYXJkRGF0YS5vd25lci5faWQ7XG4gICAgdGhpcy5fYmluZExpc3RlbmVycygpO1xuICAgIHRoaXMuX3VwZGF0ZUxpa2VTdGF0dXMoKTtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKTtcbiAgICByZXR1cm4gY2FyZFRlbXBsYXRlLmNsb25lTm9kZSh0cnVlKTtcbiAgfVxuXG4gIF9iaW5kTGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUxpa2UoKSk7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKCkpO1xuICAgIGlmICh0aGlzLl9jdXJyZW50VXNlciA9PT0gdGhpcy5fb3duZXJJZCkge1xuICAgICAgY29uc3QgZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XG4gICAgICBkZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZURlbGV0ZSgpKTtcbiAgICB9XG4gIH1cblxuICBfaGFuZGxlTGlrZSgpIHtcbiAgICBjb25zdCBpc0xpa2VkID0gdGhpcy5fbGlrZXMuc29tZSgobGlrZSkgPT4gbGlrZS5faWQgPT09IHRoaXMuX2N1cnJlbnRVc2VyKTtcbiAgICBjb25zdCBsaWtlU3RhdHVzID0gIWlzTGlrZWQ7XG4gICAgdGhpcy5fdG9nZ2xlTGlrZShsaWtlU3RhdHVzKTtcbiAgfVxuXG4gIF90b2dnbGVMaWtlKGxpa2VTdGF0dXMpIHtcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSh0aGlzLl9jYXJkSWQsIGxpa2VTdGF0dXMpXG4gICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHJlc3BvbnNlLmxpa2VzKSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdXBkYXRlZCBsaWtlczogbm90IGFuIGFycmF5XCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2xpa2VzID0gcmVzcG9uc2UubGlrZXM7XG4gICAgICAgIHRoaXMuX3VwZGF0ZUxpa2VTdGF0dXMoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciB0b2dnbGluZyBsaWtlOiAke2Vycn1gKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgX2hhbmRsZURlbGV0ZSgpIHtcbiAgICBhcGlcbiAgICAgIC5kZWxldGVDYXJkKHRoaXMuX2NhcmRJZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycm9yKSk7XG4gIH1cblxuICBfaGFuZGxlSW1hZ2VDbGljaygpIHtcbiAgICBjb25zdCBwb3B1cEltYWdlT3BlbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXBfaW1hZ2Utb3BlblwiKTtcbiAgICBjb25zdCBjbG9zZUltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cF9fY2xvc2UtaW1hZ2VcIik7XG4gICAgY29uc3QgcG9wdXBJbWFnZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2UtdGl0bGVcIik7XG4gICAgY29uc3QgcG9wdXBJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xuICAgIGNvbnN0IG92ZXJsYXlJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtb3ZlcmxheS1pbWFnZVwiKTtcbiAgICBwb3B1cEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgcG9wdXBJbWFnZVRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fdGl0bGU7XG4gICAgcG9wdXBJbWFnZS5hbHQgPSB0aGlzLl90aXRsZTtcbiAgICBwb3B1cEltYWdlT3Blbi5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgIGNsb3NlSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHBvcHVwSW1hZ2VPcGVuLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgICBvdmVybGF5SW1hZ2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZU92ZXJsYXlDbGljayk7XG4gICAgfSk7XG4gICAgb3ZlcmxheUltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBwb3B1cEltYWdlT3Blbi5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgICAgb3ZlcmxheUltYWdlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xpY2spO1xuICAgIH0pO1xuICB9XG5cbiAgX3VwZGF0ZUxpa2VTdGF0dXMoKSB7XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KHRoaXMuX2xpa2VzKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBpc0xpa2VkID0gdGhpcy5fbGlrZXMuc29tZSgobGlrZSkgPT4gbGlrZS5faWQgPT09IHRoaXMuX2N1cnJlbnRVc2VyKTtcbiAgICBpZiAoaXNMaWtlZCkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICAgIHRoaXMuX2NvdW50ZXJMaWtlcy50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl90aXRsZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fdGl0bGU7XG4gICAgdGhpcy5fdXBkYXRlTGlrZVN0YXR1cygpO1xuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoZm9ybUVsZW1lbnQsIHNldHRpbmdzKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBzZXR0aW5ncy5mb3JtU2VsZWN0b3I7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gICAgdGhpcy5pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxuICAgICk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgfSk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLmlucHV0TGlzdCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5pbnB1dExpc3QuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShlbCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjYXJkc1NlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NhcmRzU2VsZWN0b3IgPSBjYXJkc1NlbGVjdG9yO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY2FyZHNTZWxlY3Rvci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLnBvcHVwU2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMucG9wdXBDbG9zZUJ1dHRvbiA9IHRoaXMucG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIucG9wdXBfX2Nsb3NlLWJ1dHRvblwiXG4gICAgKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5wb3B1cFNlbGVjdG9yLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLnBvcHVwU2VsZWN0b3IuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIF9oYW5kbGVPdmVybGF5Q2xpY2soZXZ0KSB7XG4gICAgcmV0dXJuIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfb3BlbmVkXCIpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5wb3B1cENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnBvcHVwU2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChldnQudGFyZ2V0ID09PSB0aGlzLnBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQXZhdGFyIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCB7IGhhbmRsZUZvcm1BdmF0YXIgfSkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuaGFuZGxlRm9ybUF2YXRhciA9IGhhbmRsZUZvcm1BdmF0YXI7XG4gICAgdGhpcy5fYnV0dG9uQXZhdGFyID0gdGhpcy5wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIiNwb3B1cC1hdmF0YXJfX2Nsb3NlXCJcbiAgICApO1xuICAgIHRoaXMuX3NwYW5FcnJvciA9IHRoaXMucG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIjcG9wdXBfX2lucHV0X2F2YXRhci1lcnJvclwiXG4gICAgKTtcbiAgICB0aGlzLmZvcm1BdmF0YXIgPSB0aGlzLnBvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1hdmF0YXJfX2Zvcm1cIik7XG4gICAgdGhpcy5idXR0b25TYXZlQXZhdGFyID0gdGhpcy5wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIiNwb3B1cC1hdmF0YXJfX2J1dHRvblwiXG4gICAgKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgc3VwZXIub3BlbigpO1xuICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fYnV0dG9uQXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5mb3JtQXZhdGFyLnJlc2V0KCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLmZvcm0gPSB0aGlzLnBvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0X3RpdGxlXCIpLnZhbHVlLFxuICAgICAgbGluazogdGhpcy5wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXBfX2lucHV0X2ltYWdlXCIpLnZhbHVlLFxuICAgIH07XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5oYW5kbGVGb3JtU3VibWl0KGV2dCk7XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuZm9ybS5yZXNldCgpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLmltYWdlID0gdGhpcy5wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xuICAgIHRoaXMudGl0bGUgPSB0aGlzLnBvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2UtdGl0bGVcIik7XG4gIH1cblxuICBvcGVuKGltYWdlU3JjLCB0aXRsZVRleHQpIHtcbiAgICBzdXBlci5vcGVuKCk7XG4gICAgdGhpcy5pbWFnZS5zcmMgPSBpbWFnZVNyYztcbiAgICB0aGlzLnRpdGxlLnRleHRDb250ZW50ID0gdGl0bGVUZXh0O1xuICB9XG59XG4iLCJpbXBvcnQgXCIuL3N0eWxlcy9pbmRleC5jc3NcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuL3NjcmlwdHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4vc2NyaXB0cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi9zY3JpcHRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi9zY3JpcHRzL1BvcHVwLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoQXZhdGFyIGZyb20gXCIuL3NjcmlwdHMvUG9wdXBXaXRoQXZhdGFyLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi9zY3JpcHRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi9zY3JpcHRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgeyBhcGkgfSBmcm9tIFwiLi91dGlscy9BcGkuanNcIjtcblxuY29uc3QgaW1hZ2VQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXJcIik7XG5jb25zdCBwcm9maWxlTmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5jb25zdCBwcm9maWxlQWJvdXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hYm91dFwiKTtcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcblxuY29uc3QgZm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xuY29uc3QgZm9ybUVsZW1lbnRDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmb3JtLWNhcmRzXCIpO1xuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfbmFtZVwiKTtcbmNvbnN0IGFib3V0SW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF9hYm91dFwiKTtcbmNvbnN0IHByb2ZpbGVBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5jb25zdCB0aXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfdGl0bGVcIik7XG5jb25zdCBpbWFnZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cF9faW5wdXRfaW1hZ2VcIik7XG5jb25zdCBjYXJkQXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNcIik7XG5jb25zdCBncm91cEltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGQtaW1hZ2UtcG9wdXBcIik7XG5jb25zdCBmb3JtQ2FyZCA9IGdyb3VwSW1hZ2UucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbmNvbnN0IHByb2ZpbGVBdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtaWNvblwiKTtcbmNvbnN0IGZvcm1FbGVtZW50QXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1hdmF0YXJfX2Zvcm1cIik7XG5jb25zdCBidXR0b25TYXZlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1hdmF0YXJfX2J1dHRvblwiKTtcbmNvbnN0IGJ1dHRvblNhdmVQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1wcm9maWxlX19idXR0b25cIik7XG5jb25zdCBidXR0b25TYXZlQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtY2FyZF9fYnV0dG9uXCIpO1xuXG5sZXQgY3VycmVudFVzZXI7XG5cbmFwaS5nZXRVc2VySW5mbygpLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gIHByb2ZpbGVOYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXJEYXRhPy5uYW1lO1xuICBwcm9maWxlQWJvdXRFbGVtZW50LnRleHRDb250ZW50ID0gdXNlckRhdGE/LmFib3V0O1xuICBpbWFnZVByb2ZpbGUuc3JjID0gdXNlckRhdGE/LmF2YXRhcjtcbiAgY3VycmVudFVzZXIgPSB1c2VyRGF0YT8uX2lkO1xuXG4gIGFwaS5nZXRJbml0aWFsQ2FyZHMoKS50aGVuKChjYXJkcykgPT4ge1xuICAgIGNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHtcbiAgICAgICAgaXRlbXM6IGNhcmRzLFxuICAgICAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcbiAgICAgICAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgICAgICAgICBpdGVtLFxuICAgICAgICAgICAgXCIudGVtcGxhdGUtY2FyZFwiLFxuICAgICAgICAgICAgY3VycmVudFVzZXIsXG4gICAgICAgICAgICBsaWtlQ2FyZCxcbiAgICAgICAgICAgIGhhbmRsZUNhcmREZWxldGVcbiAgICAgICAgICApO1xuICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgICAgICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIGNhcmRBcmVhXG4gICAgKTtcblxuICAgIHNlY3Rpb24ucmVuZGVyKCk7XG4gIH0pO1xufSk7XG5cbmZ1bmN0aW9uIHNldFVzZXJJbmZvKCkge1xuICBhcGkuZ2V0VXNlckluZm8oKS50aGVuKCh1c2VyRGF0YSkgPT4ge1xuICAgIG5hbWVJbnB1dC52YWx1ZSA9IHVzZXJEYXRhPy5uYW1lO1xuICAgIGFib3V0SW5wdXQudmFsdWUgPSB1c2VyRGF0YT8uYWJvdXQ7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IG5ld05hbWUgPSBuYW1lSW5wdXQudmFsdWU7XG4gIGNvbnN0IG5ld0Fib3V0ID0gYWJvdXRJbnB1dC52YWx1ZTtcbiAgYnV0dG9uU2F2ZVByb2ZpbGUudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICBhcGlcbiAgICAubW9kaWZ5VXNlcnNJbmZvKG5ld05hbWUsIG5ld0Fib3V0KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBwcm9maWxlTmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBkYXRhPy5uYW1lO1xuICAgICAgcHJvZmlsZUFib3V0RWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGE/LmFib3V0O1xuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGJ1dHRvblNhdmVQcm9maWxlLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XG4gICAgfSk7XG59XG5cbmNvbnN0IGVkaXRQb3B1cCA9IG5ldyBQb3B1cChcIi5wb3B1cFwiKTtcblxuY29uc3QgYWRkSW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNhZGQtaW1hZ2UtcG9wdXBcIixcbiAgaGFuZGxlQWRkSW1hZ2VGb3JtU3VibWl0XG4pO1xuXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBcIiwgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xuXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3BvcHVwX2ltYWdlLW9wZW5cIik7XG5cbmNvbnN0IGVkaXRBdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhBdmF0YXIoXCIjcG9wdXAtYXZhdGFyXCIsIHtcbiAgaGFuZGxlRm9ybUF2YXRhcjogaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCxcbn0pO1xuXG5jb25zdCBvdmVybGF5RWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtb3ZlcmxheS1lZGl0XCIpO1xuY29uc3Qgb3ZlcmxheUFkZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtb3ZlcmxheS1hZGRcIik7XG5jb25zdCBvdmVybGF5SW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLW92ZXJsYXktaW1hZ2VcIik7XG5jb25zdCBvdmVybGF5QXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1vdmVybGF5LWF2YXRhclwiKTtcblxuZnVuY3Rpb24gaGFuZGxlQWRkSW1hZ2VGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgYWRkSW1hZ2VQb3B1cC5jbG9zZSgpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgYnV0dG9uU2F2ZUNhcmQudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICBpZiAodGl0bGVJbnB1dC52YWx1ZSAmJiBpbWFnZUlucHV0LnZhbHVlKSB7XG4gICAgYXBpLmdldE5ld0NhcmQodGl0bGVJbnB1dC52YWx1ZSwgaW1hZ2VJbnB1dC52YWx1ZSkudGhlbigobmV3Q2FyZCkgPT4ge1xuICAgICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgICAgICBuZXdDYXJkLFxuICAgICAgICBcIi50ZW1wbGF0ZS1jYXJkXCIsXG4gICAgICAgIGN1cnJlbnRVc2VyLFxuICAgICAgICBsaWtlQ2FyZCxcbiAgICAgICAgaGFuZGxlQ2FyZERlbGV0ZVxuICAgICAgKTtcbiAgICAgIGNvbnN0IG5ld0NhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgICAgIGNhcmRBcmVhLnByZXBlbmQobmV3Q2FyZEVsZW1lbnQpO1xuICAgICAgdGl0bGVJbnB1dC52YWx1ZSA9IFwiXCI7XG4gICAgICBpbWFnZUlucHV0LnZhbHVlID0gXCJcIjtcbiAgICAgIGFkZEltYWdlUG9wdXAuY2xvc2UoKTtcbiAgICAgIGJ1dHRvblNhdmVDYXJkLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XG4gICAgfSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IG5ld0F2YXRhclVybCA9IGZvcm1FbGVtZW50QXZhdGFyLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0XCIpLnZhbHVlO1xuICBidXR0b25TYXZlQXZhdGFyLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgYXBpLnJlc2V0QXZhdGFyKG5ld0F2YXRhclVybCkudGhlbigoZGF0YSkgPT4ge1xuICAgIGltYWdlUHJvZmlsZS5zcmMgPSBkYXRhPy5hdmF0YXI7XG4gICAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XG4gICAgYnV0dG9uU2F2ZUF2YXRhci50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gbGlrZUNhcmQoY2FyZElkLCBpc0xpa2VkKSB7XG4gIHJldHVybiBhcGlcbiAgICAubGlrZUNhcmQoY2FyZElkLCBpc0xpa2VkKVxuICAgIC50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xuICAgICAgcmV0dXJuIHVwZGF0ZWRDYXJkO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIHRocm93IGVycjtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQ2FyZERlbGV0ZShjYXJkSWQpIHtcbiAgYXBpLmRlbGV0ZUNhcmQoY2FyZElkKS50aGVuKCgpID0+IHtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNhcmRJZCk7XG4gICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVPdmVybGF5Q2xpY2soZXZlbnQpIHtcbiAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fb3ZlcmxheVwiKSkge1xuICAgIGVkaXRQb3B1cC5jbG9zZSgpO1xuICAgIGFkZEltYWdlUG9wdXAuY2xvc2UoKTtcbiAgICBpbWFnZVBvcHVwLmNsb3NlKCk7XG4gICAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY2xvc2VQb3B1cHMoKSB7XG4gIGVkaXRQb3B1cC5jbG9zZSgpO1xuICBhZGRJbWFnZVBvcHVwLmNsb3NlKCk7XG4gIGltYWdlUG9wdXAuY2xvc2UoKTtcbiAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGNsb3NlV2l0aEVzYyk7XG59XG5cbmZ1bmN0aW9uIGNsb3NlV2l0aEVzYyhldmVudCkge1xuICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgY2xvc2VQb3B1cHMoKTtcbiAgfVxufVxuXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBlZGl0UG9wdXAub3BlbigpO1xuICBzZXRVc2VySW5mbygpO1xufSk7XG5cbmZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xucHJvZmlsZUFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gYWRkSW1hZ2VQb3B1cC5vcGVuKCkpO1xuZm9ybUNhcmQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcbnByb2ZpbGVBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGVkaXRBdmF0YXJQb3B1cC5vcGVuKCkpO1xuZm9ybUVsZW1lbnRBdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KTtcblxuYWRkSW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5vdmVybGF5RWRpdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlT3ZlcmxheUNsaWNrKTtcbm92ZXJsYXlBZGQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZU92ZXJsYXlDbGljayk7XG5vdmVybGF5SW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZU92ZXJsYXlDbGljayk7XG5vdmVybGF5QXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVPdmVybGF5Q2xpY2spO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZXZlbnQpID0+IGNsb3NlV2l0aEVzYyhldmVudCkpO1xuXG5jb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zYXZlLWJ1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbmNvbnN0IHZhbGlkYXRlRm9ybVByb2ZpbGUgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtRWxlbWVudCwgc2V0dGluZ3MpO1xudmFsaWRhdGVGb3JtUHJvZmlsZS5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmNvbnN0IHZhbGlkYXRlRm9ybUNhcmQgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtRWxlbWVudENhcmQsIHNldHRpbmdzKTtcbnZhbGlkYXRlRm9ybUNhcmQuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5jb25zdCB2YWxpZGF0ZUZvcm1BdmF0YXIgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtRWxlbWVudEF2YXRhciwgc2V0dGluZ3MpO1xudmFsaWRhdGVGb3JtQXZhdGFyLl9zZXRFdmVudExpc3RlbmVycygpO1xuIl0sIm5hbWVzIjpbImFwaSIsIkFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsImtleSIsInZhbHVlIiwiZmV0Y2giLCJjb25jYXQiLCJ0aGVuIiwicmVzIiwib2siLCJFcnJvciIsInN0YXR1cyIsImpzb24iLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsIl9vYmplY3RTcHJlYWQiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImxpbmsiLCJjYXJkSWQiLCJpc0xpa2VkIiwiaWQiLCJ1cmwiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwiQ2FyZCIsImNhcmREYXRhIiwidGVtcGxhdGVTZWxlY3RvciIsImN1cnJlbnRVc2VyIiwiaGFuZGxlQ2FyZExpa2UiLCJoYW5kbGVDYXJkRGVsZXRlIiwiX3RpdGxlIiwiX2xpbmsiLCJfbGlrZXMiLCJBcnJheSIsImlzQXJyYXkiLCJsaWtlcyIsIl9jYXJkSWQiLCJfaWQiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9lbGVtZW50IiwiX2dldFRlbXBsYXRlIiwiX2NhcmRJbWFnZSIsInF1ZXJ5U2VsZWN0b3IiLCJfY2FyZFRpdGxlIiwiX2xpa2VCdXR0b24iLCJfY291bnRlckxpa2VzIiwiX2N1cnJlbnRVc2VyIiwiX2hhbmRsZUNhcmRMaWtlIiwiX2hhbmRsZUNhcmREZWxldGUiLCJfb3duZXJJZCIsIm93bmVyIiwiX2JpbmRMaXN0ZW5lcnMiLCJfdXBkYXRlTGlrZVN0YXR1cyIsImRvY3VtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsIl90aGlzIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlIiwiX3RoaXMyIiwibGlrZVN0YXR1cyIsInNvbWUiLCJsaWtlIiwiX3RvZ2dsZUxpa2UiLCJfdGhpczMiLCJyZXNwb25zZSIsImVyciIsIl90aGlzNCIsImRlbGV0ZUNhcmQiLCJyZW1vdmUiLCJfdGhpczUiLCJwb3B1cEltYWdlT3BlbiIsImNsb3NlSW1hZ2UiLCJwb3B1cEltYWdlVGl0bGUiLCJwb3B1cEltYWdlIiwib3ZlcmxheUltYWdlIiwic3JjIiwidGV4dENvbnRlbnQiLCJhbHQiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiX2hhbmRsZU92ZXJsYXlDbGljayIsIl90aGlzNiIsImxlbmd0aCIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtRWxlbWVudCIsInNldHRpbmdzIiwiX2Zvcm1FbGVtZW50IiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9idXR0b25FbGVtZW50IiwiaW5wdXRMaXN0IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGFzSW52YWxpZElucHV0IiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJmb3JFYWNoIiwiZWwiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiU2VjdGlvbiIsIl9yZWYiLCJjYXJkc1NlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jYXJkc1NlbGVjdG9yIiwiaXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwicG9wdXBDbG9zZUJ1dHRvbiIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoQXZhdGFyIiwiX1BvcHVwIiwiaGFuZGxlRm9ybUF2YXRhciIsIl9jYWxsU3VwZXIiLCJfYnV0dG9uQXZhdGFyIiwiX3NwYW5FcnJvciIsImZvcm1BdmF0YXIiLCJidXR0b25TYXZlQXZhdGFyIiwiX2luaGVyaXRzIiwiX2dldCIsIl9nZXRQcm90b3R5cGVPZiIsInByb3RvdHlwZSIsImNhbGwiLCJzZXRFdmVudExpc3RlbmVycyIsInJlc2V0IiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJmb3JtIiwiUG9wdXBXaXRoSW1hZ2UiLCJpbWFnZSIsInRpdGxlIiwiaW1hZ2VTcmMiLCJ0aXRsZVRleHQiLCJpbWFnZVByb2ZpbGUiLCJwcm9maWxlTmFtZUVsZW1lbnQiLCJwcm9maWxlQWJvdXRFbGVtZW50IiwicHJvZmlsZUVkaXRCdXR0b24iLCJmb3JtRWxlbWVudENhcmQiLCJuYW1lSW5wdXQiLCJhYm91dElucHV0IiwicHJvZmlsZUFkZEJ1dHRvbiIsInRpdGxlSW5wdXQiLCJpbWFnZUlucHV0IiwiY2FyZEFyZWEiLCJmb3JtQ2FyZCIsImdldEVsZW1lbnRCeUlkIiwicHJvZmlsZUF2YXRhckJ1dHRvbiIsImZvcm1FbGVtZW50QXZhdGFyIiwiYnV0dG9uU2F2ZVByb2ZpbGUiLCJidXR0b25TYXZlQ2FyZCIsImhhbmRsZVByb2ZpbGVGb3JtU3VibWl0IiwibmV3TmFtZSIsIm5ld0Fib3V0IiwibW9kaWZ5VXNlcnNJbmZvIiwiZGF0YSIsImVkaXRQcm9maWxlUG9wdXAiLCJmaW5hbGx5IiwiZ2V0VXNlckluZm8iLCJ1c2VyRGF0YSIsImdldEluaXRpYWxDYXJkcyIsImNhcmRzIiwic2VjdGlvbiIsImNhcmRFbGVtZW50IiwibGlrZUNhcmQiLCJnZW5lcmF0ZUNhcmQiLCJhZGRJdGVtIiwicmVuZGVyIiwiZWRpdFBvcHVwIiwiYWRkSW1hZ2VQb3B1cCIsImltYWdlUG9wdXAiLCJlZGl0QXZhdGFyUG9wdXAiLCJoYW5kbGVBdmF0YXJGb3JtU3VibWl0Iiwib3ZlcmxheUVkaXQiLCJvdmVybGF5QWRkIiwib3ZlcmxheUF2YXRhciIsIm5ld0F2YXRhclVybCIsInJlc2V0QXZhdGFyIiwidXBkYXRlZENhcmQiLCJoYW5kbGVPdmVybGF5Q2xpY2siLCJldmVudCIsImNsb3NlV2l0aEVzYyIsIm9wZW4iLCJnZXROZXdDYXJkIiwibmV3Q2FyZCIsIm5ld0NhcmRFbGVtZW50Il0sInNvdXJjZVJvb3QiOiIifQ==